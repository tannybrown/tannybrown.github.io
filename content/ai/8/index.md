---
emoji: π”®
title: 7. Gradient Descent κ³ κΈ‰νΈ
date: '2023-02-02 10:00:00'
author: tanny
tags: 
categories: AI/ML/DL
---

## 0. μ§€λ‚ μ΄μ•ΌκΈ°

[μ΄μ „κΈ€](https://tannybrown.github.io/ai/7/)μ—μ„λ” SGD, mini-batch SGDμ— λ€ν•΄μ„ μ•μ•„λ³΄μ•λ‹¤.<br>
μ΄λ²κΈ€μ—μ„λ” mini-batchμ—μ„ λ°μ „λ μ•κ³ λ¦¬μ¦λ“¤μ„ μ•μ•„λ³΄μ.
<br><br>


## 1. Momentum SGD
mini-batch SGDμ λ‹¨μ μ€ λ­κ°€ μμ„κΉ? batchμ‚¬μ΄μ¦λ¥Ό ν‚¤μ› λ‹¤κ³  ν•λ”λΌλ„, GD(Gradient Descent)λ³΄λ‹¤ optimalν• κ°’μ— 'μ •ν™•ν•' λ°©ν–¥μΌλ΅ λ‚μ•„κ°€μ§„ μ•λ”λ‹¤λ” μ μΌ κ²ƒμ΄λ‹¤.<br>
κ·Έλ¦Όμ„ ν†µν•΄ ν™•μΈν•΄λ³΄λ©΄ λ‹¤μκ³Ό κ°™λ‹¤.
<br>
![image](https://user-images.githubusercontent.com/121401159/216329482-e6ac4581-3e14-4c80-ac14-a002fec74982.png)<br>
μΆμ°λ΅ λ„λ¬΄ λ§μ΄ ν”λ“¤λ¦¬μ§€ μ•λ”κ°€? μ΄λ¬ν• λ‹¨μ μ„ λ³΄μ™„ν•κ³ μ λ‚μ¨κ²ƒμ΄ Momentum SGDμ΄λ‹¤. <br>
momentum SGDμ„ μ§κ΄€μ μΌλ΅ μ„¤λ…ν•μλ©΄, κ΄€μ„±μ„ κ³ λ ¤ν•λ” update λ°©λ²•μ΄λΌκ³  λ§ν•  μ μλ‹¤. <br>
μ¦‰ μ΄μ „μ gradientλ“¤μ„ κ³ λ ¤ν•΄μ„ κ°€μ¤‘μΉλ¥Ό μ—…λ°μ΄νΈν•λ” λ°©λ²•μ΄λ‹¤.<br>
![image](https://user-images.githubusercontent.com/121401159/216331203-86f04a3e-1ebc-4b8f-82c0-71aedc3a5a4a.png)<br>
κ·Έλ¦¬κ³  μ—¬κΈ°μ„, optimal ν• κ°’μ— κ±°μ λ„λ‹¬ν–μ„λ•λ” κ΄€μ„±(?)λ•λ¬Έμ— λΉ™κΈ€λΉ™κΈ€ λκ² λλ‹¤.<br>
λ”°λΌμ„, momentum SGDμ κ²½μ° κ³Όμ ν•©(overfitting)μ„ λ°©μ§€ν•κ³  ν•™μµμ„ κ°μ„ ν•λ” ν¨κ³Όκ°€ μλ‹¤.


## 2. RMSProp
μ΄λ²μ—” λ λ‹¤λ¥Έ μ•κ³ λ¦¬μ¦μ„ μ‚΄ν΄λ³΄μ. <br>
RMSProp(Root Mean Square Propagation)μ€ μ§€μμ΄λ™ν‰κ· (EMA)μ„ μ‚¬μ©ν•μ—¬ κ° νλΌλ―Έν„°μ κ²½μ‚¬ μ κ³± κ°’μ„ κ³„μ‚°ν•μ—¬, κ²½μ‚¬μ μ§€μμ΄λ™ν‰κ· μ„ μ μ©ν•μ—¬ κ°€μ¤‘μΉλ¥Ό μ—…λ°μ΄νΈν•λ‹¤. RMSPropμ€ **ν•™μµλ¥ **λ„ μ΅°μ ν•λ” κΈ°λ²•μΈλ°, Gradientμ λ³€ν™”κ°€ ν° νλΌλ―Έν„°μ— λ€ν•΄μ„λ” ν•™μµλ¥ μ„ μ‘κ² μ΅°μ ν•κ³ , Gradientμ λ³€ν™”κ°€ μ‘μ€ νλΌλ―Έν„°μ— λ€ν•΄μ„λ” ν•™μµλ¥ μ„ ν¬κ² μ΅°μ ν•λ‹¤. μ΄λ¥Ό ν†µν•΄ κ° νλΌλ―Έν„°μ— λ€ν• **ν•™μµμ μ•μ •μ„±**μ„ λ†’μ΄κ³ , **ν•™μµ μ†λ„λ¥Ό κ°μ„ **ν•  μ μλ‹¤.<br>
<br>
μλ¨λ¥΄κ² λ‹¤κ³ ? κ·Έλ΄ κ²ƒ κ°™μ•„μ„ ν•λ²λ” μ •λ¦¬ν•λ©΄ λ‹¤μκ³Ό κ°™λ‹¤.<br>
1. Gradient κ³„μ‚° : ν„μ¬ μƒνƒμ νλΌλ―Έν„°μ— λ€ν• Gradientλ¥Ό κ³„μ‚°.
2. μ§€μμ΄λ™ν‰κ·  κ³„μ‚° : κ° νλΌλ―Έν„°μ— λ€ν• gradient μ κ³± κ°’μ EMAλ¥Ό κ³„μ‚°ν•λ‹¤.
3. ν•™μµλ¥  κ³„μ‚° : EMAλ¥Ό μ΄μ©ν•΄μ„ κ° νλΌλ―Έν„°μ— λ€ν• ν•™μµλ¥ μ„ κ³„μ‚°ν•λ‹¤.
4. νλΌλ―Έν„° μ—…λ°μ΄νΈ : κ³„μ‚°λ ν•™μµλ¥ μ„ μ΄μ©ν•μ—¬ νλΌλ―Έν„°λ¥Ό μ—…λ°μ΄νΈν•λ‹¤.

> μ΄μ‹¬μμ κ²½μ°, μ΄ λ¶€λ¶„μ€ λ„κ²¨λ„ μΆ‹λ‹¤. μ™ μ“°λ”μ§€ μ •λ„λ§ μ΄ν•΄ν•λ„λ΅ ν•μ.

```
μλ¥Ό λ“¤μ–΄λ³΄μ.
ν„μ¬ νλΌλ―Έν„°μ κ°’μ΄ [0.8, 1.2, 0.5]μ΄κ³ , κ²½μ‚¬ κ°’μ΄ [0.1, -0.3, 0.2]μΌ λ•, EMAλ” λ‹¤μκ³Ό κ°™μ΄ κµ¬ν•  μ μλ‹¤.
μ²« λ²μ§Έ νλΌλ―Έν„°(0.8)μ κ²½μ‚¬ μ κ³± κ°’: 0.1^2 = 0.01 
λ‘ λ²μ§Έ νλΌλ―Έν„°(1.2)μ κ²½μ‚¬ μ κ³± κ°’: -0.3^2 = 0.09 
μ„Έ λ²μ§Έ νλΌλ―Έν„°(0.5)μ κ²½μ‚¬ μ κ³± κ°’: 0.2^2 = 0.04 

μ²« λ²μ§Έ νλΌλ―Έν„°μ EMA(0.01)μ€ 0.01 * 0.9 + 0.01 * 0.1 = 0.009
λ‘ λ²μ§Έ νλΌλ―Έν„°μ EMA(0.09)μ€ 0.09 * 0.9 + 0.09 * 0.1 = 0.081
μ„Έ λ²μ§Έ νλΌλ―Έν„°μ EMA(0.04)μ€ 0.04 * 0.9 + 0.02 * 0.1 = 0.038

ν•™μµλ¥ μ€ λ‹¤μκ³Ό κ°™μ΄ κ³„μ‚°μ΄ κ°€λ¥ν•λ‹¤.
μ²« λ²μ§Έ νλΌλ―Έν„°μ ν•™μµλ¥ : 0.01 / (0.009 + Ξµ)^0.5 = 0.1
λ‘ λ²μ§Έ νλΌλ―Έν„°μ ν•™μµλ¥ : 0.09 / (0.081 + Ξµ)^0.5 = 0.3
μ„Έ λ²μ§Έ νλΌλ―Έν„°μ ν•™μµλ¥ : 0.02 / (0.038 + Ξµ)^0.5 = 0.2
Ξµλ” μ•„μ£Ό μ‘μ€ κ°’μΌλ΅ μμΉ μ•μ •μ„±μ„ λ³΄μ¥ν•λ” λ©μ μΌλ΅ μ‚¬μ©λλ‹¤.

κ·Έλ¦¬κ³ , μ΄μ  ν•™μµλ¥ μ„ μ΄μ©ν•μ—¬ νλΌλ―Έν„°λ¥Ό μ—…λ°μ΄νΈν•  μ μλ‹¤.
μ²« λ²μ§Έ νλΌλ―Έν„°: 0.8 - 0.1 * 0.1 = 0.79
λ‘ λ²μ§Έ νλΌλ―Έν„°: 1.2 - 0.3 * 0.3 = 1.11
μ„Έ λ²μ§Έ νλΌλ―Έν„°: 0.5 - 0.2 * 0.2 = 0.48
```

<br>
<br>

## 3. Adam
Adamμ€ μ•μ„ μ‚΄ν΄λ³Έ Momentumκ³Ό RMSPropμ μ¥μ μ„ ν•©μΉ μ•κ³ λ¦¬μ¦μ΄λ‹¤. λ”°λΌμ„ κ°€μ¥ λ§μ΄ μ‚¬μ©λλ” μ•κ³ λ¦¬μ¦μ΄λΌκ³  λ³Ό μ μλ‹¤.<br>
μ¦‰, momentλ„ κ³„μ‚°ν•κ³ , ν•™μµλ¥ λ„ λ³€ν™”μ‹μΌμ£Όλ” μ•κ³ λ¦¬μ¦μ΄λ‹¤.<br>
ν„ λ‹¨κ³„μ—μ„λ” μμ„Έν• μμ‹μ€ μ ‘μ–΄λ‘κ³  μ΄μ •λ„μ κ°λ…λ§ μ•μ•„λ‘λ„λ΅ ν•μ.<br>
<br><br>



## 4. λ§λ¬΄λ¦¬
![image](https://user-images.githubusercontent.com/121401159/216343301-4c2a4fcf-3f78-4612-b779-781576e7d801.png)<br>

μ΄λ²μ‹κ°„μ—” mini-batchμ—μ„ λ°μ „λ 3κ°€μ§€ μ•κ³ λ¦¬μ¦μ— λ€ν•΄ μ‚΄ν΄λ³΄μ•λ‹¤.<br>
λ‹¤μκΈ€μ—μ„λ” Training dataμ™€ Test dataμ— λ€ν•΄ μ•μ•„λ³΄μ.

```toc

```