---
emoji: 🔮
title: 13. 다중분류는 어떻게 설계해야하는가?
date: '2023-02-14 20:00:00'
author: tanny
tags: 
categories: AI/ML/DL
---

## 0. 지난 이야기
[이전글](https://tannybrown.github.io/ai/13/)에서 이진분류에 대해 다루었고,<br>
이번글에서는 다중분류에 대해 다루려고 한다.<br>

<br>
<br>

## 1. 출력은 몇개로 할까?
이진분류에서는 출력을 하나로 잡았다. sigmoid 를 이용해서 중간을 기점으로 이진분류를 진행했다.<br>
그렇다면 다중분류에서도 마찬가지로 출력을 하나로 둬도 될까?<br>
Noop! 안된다. 왜 안될까?
> 언제나 reasoning이 중요하다. 왜? 왜? 왜?를 붙여보자.

### (1) 불공평한 backpropagation
불공평? 무슨뜻인가 하니, 예를 들어 삼중분류를 한다고 가정해보자. <br>그렇다면 마지막 출력층의 sigmoid의 영역을 설정하여 3개의 class에 매핑을 시켜야 할것이다.<br>
![image](https://user-images.githubusercontent.com/121401159/218678225-edc36681-f12d-4d04-bf56-9e123016dc78.png)<br>
위 예는 A클래스는 0, B클래스는 1/2, C클래스는 1로 잡은 예이다.<br> 
이렇게 될 경우, B클래스는 항상 큰 gradient를 갖게 되고 A와 C클래스는 상대적으로 작은 Gradient를 갖게 되어 학습이 잘 이뤄지지 않을 것이다.
> 이진분류에서는 왜 가능했나요?<br>
> 이진분류때는 정답을 0과 1로 나누었고, (0,1/2)을 기점으로 점대칭이었기때문에 가능했다.

### (2) 분류 가짓수가 많아지면..?
분류가짓수가 1000개라면? sigmoid를 1000개로 쪼갤것인가? 이러한 경우 아주 약간의 가중치 변화로도 다른 class로 분류되며 오류가 커질 것이다.
<br>

### (3) 이상한 사전 정보
![image](https://user-images.githubusercontent.com/121401159/218679849-941e63b6-9386-4b9f-83db-00903615d746.png)
<br>
위 ABC클래스를 각각 소 고양이 강아지라고 해보자. <br>
그러면 우린 의도하지 않았지만, 소와 고양이는 가깝고 소와 강아지는 멀다는 사전정보를 주게 된다.<br>
그리고 소와 강아지 중간은 고양이라는 이상한 정보 또한 주어지게 된 것이다.<br>
> 즉 각 클래스별로의 관련성은 우리가 고려했던 정보는 아닌데, 의도치 않게 주게 된 것.

그래서 소처럼 생긴 강아지가 input으로 들어온다면, 고양이라고 해버리는 경우가 생길 수 있는 것이다.<br>


## 2. n개로 하자!
출력을 1개로 두자니, 위와 같은 문제들이 발생한다. 따라서 이러한 문제들을 해결하기 위해서 출력을 n개로 두는 방법을 택했다.<br>
n은 클래스의 수이다. 5개로 분류한다면 5, 10개로 분류한다면 10.<br>
그러면 정답은 어떻게 판별할까? 이는 one-hot encoding을 이용한다.<br>
예를 들어서, 소 고양이 강아지를 분류하는 모델이라면<br>
![image](https://user-images.githubusercontent.com/121401159/218682429-4a0a1f43-75dc-4672-bb57-a26c05dbd334.png)
<br>
이렇게 각 클래스를 담당하는 출력 노드가 존재하고, 1 0 0 , 0 1 0, 0 0 1 과 같은 출력으로 각 클래스를 구분한다.<br>
> 1 0 0 , 0 1 0, 0 0 1 과 같이 정답만 1 나머지는 0 으로 표현하여 각 클래스를 구분하는 방법을 one-hot encoding이라고 한다.



